{"version":3,"file":"index.js","sources":["../src/components/NoAuth/index.tsx","../src/components/NameRedirect/index.tsx","../src/components/Spin/index.tsx","../src/changeable.tsx","../src/GeneratorHookCom.tsx","../src/components/NotFound/index.tsx","../src/util.tsx","../src/getInitialState.ts","../src/Context/MRouterHistoryContext.tsx","../src/BrowserRouter.tsx","../src/HashRouter.tsx","../src/type.ts","../src/actions.ts","../src/Context/MRouterContext.tsx","../src/index.tsx"],"sourcesContent":["import * as React from 'react';\n\nconst PageConfig = {\n  '401': {\n    title: '无权限查看该页面',\n    img: '//ysf.qiyukf.net/yx/9c9ce7793b3c0657da5d80e740a89681',\n  },\n  '404': {\n    title: '页面不存在',\n    img: 'https://ysf.nosdn.127.net/ysh/6be90dea7806767fe65e7b48982b7a61',\n  },\n} as Record<string, {title: string; img: string}>;\n\nconst NoAuth: React.FC<{ code?: string }> = ({ code = '401' }) => {\n  const config = PageConfig[code];\n  return (\n    <div\n      style={{\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        background: 'white',\n        height: '100%',\n        flexDirection: 'column',\n        borderRadius: 8,\n      }}\n    >\n      <img alt={config.title} width={200} src={config?.img} />\n      <div\n        style={{ color: '#666666', lineHeight: '22px', textAlign: 'center', marginTop: 16 }}\n      >\n        {config.title}\n      </div>\n    </div>\n  );\n};\n\nNoAuth.displayName = 'NoAuth';\n\nexport default NoAuth;\n","import * as React from 'react';\nimport { Navigate } from 'react-router-dom';\nimport { useRouter } from '../../index';\n\nconst NameRedirect: React.FC<{ name: string; component?: React.ComponentType<any> }> = ({ name, component: Component }) => {\n  const { routesMap, currentRoute } = useRouter();\n\n  const targetRoute = routesMap[name];\n\n  if (!targetRoute) {\n    if (__DEV__) {\n      Error(`routesMap.${name} 路由不存在`);\n    }\n  }\n\n  if (name === currentRoute.name) {\n    if (Component) {\n      // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n      // @ts-expect-error\n      return <Component />;\n    }\n    return <></>;\n  }\n\n  return <Navigate to={targetRoute.path || ''} />;\n};\n\nexport default NameRedirect;\n","import * as React from 'react';\nconst Spin:React.FC<{tip: string}> = ({tip = \"加载中\"})  => {\n  return <div>{tip}</div>;\n}\n\nexport default Spin;\n","import * as React from 'react';\nimport Spin from './components/Spin'\nconst LoadingCmp = () => <><Spin tip=\"应用正在加载中…\" /></>;\n\n/**\n * LoadingComponent Define the Suspense component's fallback and beforeEnter when a component is loaded, \n * and the state component when calling next\n */\ninterface ChangeableI {\n    LoadingComponent: React.FunctionComponent<any>\n}\n\nconst changeable: ChangeableI = {\n    LoadingComponent: LoadingCmp,\n}\n\nfunction setChangeable(options: Partial<ChangeableI>) {\n    Object.entries(options).forEach(([key , value]) => {\n        changeable[key as keyof ChangeableI] = value\n    })\n}\n\nexport {\n    changeable,\n    setChangeable\n}","import * as React from \"react\";\nimport { useLayoutEffect, useState } from \"react\";\nimport { Navigate } from \"react-router-dom\";\nimport NameRedirect from \"./components/NameRedirect\";\nimport type {\n  BeforeEachMountI,\n  BeforeEnterI,\n  NextOptionsType,\n  RouteTypeI\n} from \"./type\";\n\nimport { useRouter } from \"./index\";\nimport { isComponent, isString } from \"./util\";\nimport { changeable } from \"./changeable\";\n\nfunction getComponent(\n  options?: NextOptionsType,\n  Component?: React.ComponentType\n) {\n  let ReplaceComponent: React.ComponentType<any> | undefined;\n  if (!options) {\n    return ReplaceComponent;\n  }\n  // if a component is passed in\n  if (isComponent(options)) {\n    ReplaceComponent = options as React.ComponentType<any>;\n    // @ts-ignore\n  } else if (isString(options.path)) {\n    // if there is path, path is preferred\n    ReplaceComponent = function Redirect() {\n      // @ts-ignore\n      return <Navigate to={options.path!} />;\n    };\n     // @ts-ignore\n  } else if (isString(options.name)) {\n    // if there is no path, use name\n    ReplaceComponent = function Redirect() {\n      // @ts-ignore\n      return <NameRedirect name={options.name!} component={Component} />;\n    };\n  }\n  return ReplaceComponent;\n}\n\nexport const GeneratorHookCom: React.FC<{\n  beforeEnter?: BeforeEnterI;\n  beforeEachMount?: BeforeEachMountI;\n  Component: any;\n  _route: RouteTypeI;\n}> = ({ beforeEnter, Component, beforeEachMount }) => {\n  /**\n   * since setCurrentComponent(Component) Component may be a function\n   * react by default, if the preState is a function, the function will be executed and an error will occur\n   * So here we put Component into an object\n   */\n  const [CurrentComponent, setCurrentComponent] = useState<{ Component: any }>({\n    Component: undefined\n  });\n  const { currentRoute } = useRouter();\n  useLayoutEffect(() => {\n    // 是否激活状态(未卸载)\n    let isActive = true;\n    // 全局的\n    if (beforeEachMount) {\n      beforeEachMount(currentRoute, options => {\n        if (!isActive) {\n          return;\n        }\n\n        // global\n        const EachReplaceComponent = getComponent(options, Component);\n        if (beforeEnter) {\n          // local\n          beforeEnter(currentRoute, enterOptions => {\n            if (!isActive) {\n              return;\n            }\n            const EnterReplaceComponent = getComponent(\n              enterOptions,\n              EachReplaceComponent || Component\n            );\n            // if the Component is passed in next in beforeEnter, the beforeEnter shall prevail\n\n            // Otherwise, beforeEachBeforeMount shall prevail\n            setCurrentComponent({\n              Component:\n                EnterReplaceComponent || EachReplaceComponent || Component\n            });\n          });\n        } else {\n          setCurrentComponent({ Component: EachReplaceComponent || Component });\n        }\n      });\n    } else {\n      // local\n      if (beforeEnter) {\n        beforeEnter(currentRoute, enterOptions => {\n          if (!isActive) {\n            return;\n          }\n          const EnterReplaceComponent = getComponent(enterOptions, Component);\n          setCurrentComponent({\n            Component: EnterReplaceComponent || Component\n          });\n        });\n      }\n    }\n    return () => {\n      isActive = false;\n    };\n  }, [Component, currentRoute, beforeEnter, beforeEachMount]);\n  const LoadingCmp = changeable.LoadingComponent;\n  return CurrentComponent.Component ? (\n    <CurrentComponent.Component />\n  ) : (\n    <LoadingCmp />\n  );\n};\n\nexport default GeneratorHookCom;\n","import * as React from 'react';\nimport NoAuth from '../NoAuth';\n\nconst NotFound: React.FC = () => {\n  return <NoAuth code=\"404\" />;\n};\n\nexport default NotFound;\n","import * as React from 'react';\nimport type { To } from 'react-router';\nimport { Navigate } from 'react-router';\nimport NoAuth from './components/NoAuth';\nimport type {\n  BeforeEachMountI,\n  CodeType,\n  FnCodeType,\n  PermissionListType,\n  RouteCbI,\n  RouteEvent,\n  RouteTypeExtendsI,\n  RouteTypeI,\n  RouteTypeInputI,\n  RouteTypePropsI,\n  RouterConfigI,\n  RoutesMapI,\n  RouterBaseConfigI,\n  NewStateQueryI,\n  NewStateI,\n} from './type';\nimport GeneratorHookCom from './GeneratorHookCom';\nimport NotFound from './components/NotFound';\nimport { setChangeable } from './changeable';\n\nlet incrementKey = 1;\nconst getIncrementName = () => {\n  const name = `__routerName${incrementKey}`;\n  incrementKey = incrementKey + 1;\n  return name;\n};\n\nfunction getWholePath (path: string, basename = '/', parentPath?: string): string {\n  if (path.startsWith(basename)) {\n    return path;\n  }\n  // 根路径\n  if (path === basename) {\n    return basename;\n  }\n\n  if (path.startsWith('/')) {\n    if (basename.endsWith('/')) {\n      return `${basename}${path.slice(1)}`;\n    }\n    return `${basename}${path}`;\n  }\n\n  if (parentPath) {\n    return getWholePath(path, parentPath);\n  }\n\n  if (basename.endsWith('/')) {\n    return `${basename}${path}`;\n  }\n  return `${basename}/${path}`;\n}\n\nexport function cloneRoutes (_routeConfig: {\n  routes: RouteTypeI[]\n  parent?: RouteTypeInputI\n  basename?: string\n  _level?: number\n}): RouteTypeInputI[] {\n  const { routes, parent, basename = '/', _level = 1 } = _routeConfig;\n  if (!routes) {\n    return [];\n  }\n  if (!Array.isArray(routes)) {\n    Error('MRouter route prop need to type Array<RouteTypeI>');\n  }\n  function _cloneRoutes (_routes: RouteTypeI[], parent?: RouteTypeInputI, _level = 1): RouteTypeInputI[] {\n    return _routes.map(_route => {\n      const { path, items, children, ...resets } = _route;\n      const wholePath = getWholePath(path, basename, parent?.path);\n      const newRoute: RouteTypeInputI = {\n        ...resets,\n        path: getValidPathname(wholePath),\n        parent,\n        _level,\n        _relativePath: path,\n      };\n      if (items) {\n        newRoute.items = _cloneRoutes(items, newRoute, _level + 1);\n      }\n      if (children) {\n        newRoute.children = _cloneRoutes(children, newRoute, _level + 1);\n      }\n\n      return newRoute;\n    });\n  }\n  return _cloneRoutes(routes, parent, _level);\n}\n\n/**\n *cCalculate some state data\n * @param inputRoutes\n * @param permissionList\n * @returns\n */\nexport function computedNewState (config: NewStateQueryI):NewStateI {\n  const { inputRoutes, permissionList, hasAuth, beforeEachMount, basename, location } = config;\n  const authInputRoutes = computeRoutesConfig({\n    routes: inputRoutes,\n    permissionList,\n    hasAuth,\n    beforeEachMount,\n  });\n  const flattenRoutes = flattenRoutesFn(authInputRoutes, undefined, true);\n  // mixin into the notFound page\n  mixinNotFoundPage(flattenRoutes, basename, authInputRoutes);\n  const routesMap = routesMapFn(flattenRoutes);\n  const currentRoute = getCurrentRoute(location.pathname, routesMap);\n  const currentPathRoutes = getCurrentPathRoutes(currentRoute);\n \n  return {\n    authInputRoutes,\n    flattenRoutes,\n    routesMap,\n    currentRoute,\n    currentPathRoutes,\n    beforeEachMount,\n  };\n}\n\n/**\n * flatten the react router array recursively\n * whether all is true, includes sub routes\n */\nexport const flattenRoutesFn = (\n  arr: RouteTypeExtendsI[],\n  parent?: RouteTypeExtendsI,\n  all?: boolean\n): RouteTypeExtendsI[] => {\n  return arr.reduce((prev: RouteTypeExtendsI[], nextRoute: RouteTypeExtendsI) => {\n    if (parent) {\n      nextRoute.parent = parent;\n    }\n    if (Array.isArray(nextRoute.items) || Array.isArray(nextRoute.children)) {\n      let _routes = prev.concat(nextRoute);\n      if (Array.isArray(nextRoute.items)) {\n        _routes = _routes.concat(flattenRoutesFn(nextRoute.items, nextRoute, all));\n      }\n      if (Array.isArray(nextRoute.children) && all) {\n        _routes = _routes.concat(flattenRoutesFn(nextRoute.children, nextRoute, all));\n      }\n      return _routes;\n    } else {\n      return prev.concat(nextRoute);\n    }\n  }, []);\n};\n\n// name => mapping of route\nexport const routesMapFn = (flattenRoutes: RouteTypeExtendsI[]): RoutesMapI => {\n  const routesMap = flattenRoutes.reduce(\n    (_routeMap: RoutesMapI, nextRoute: RouteTypeExtendsI) => {\n      const { name, path } = nextRoute;\n      if (_routeMap[name] || _routeMap[path]) {\n\n        throw new Error(`route config name or path isn't unique, route name: \"${name}\", route path: \"${path}\"`);\n      }\n      // the route has params\n      // stored internally '__paramsRoutes' variable\n      if (path.includes(':')) {\n        const _path = path.replace(/:(\\w+)/g, () => {\n          return '([^\\\\/]+)';\n        });\n        _routeMap.__paramsRoutesMap[_path] = nextRoute;\n      }\n      _routeMap[name] = _routeMap[path] = nextRoute;\n      return _routeMap;\n    },\n    {\n      __paramsRoutesMap: {},\n      __flattenRoutes: [] as RouteTypeExtendsI[],\n    } as RoutesMapI\n  );\n  routesMap.__flattenRoutes = flattenRoutes;\n  return routesMap;\n};\n\n// convert '/a/b/c/' to '/a/b/c'\nfunction getValidPathname (pathname: string) {\n  if (!pathname) {\n    return pathname;\n  }\n  if (pathname.endsWith('/')) {\n    return pathname.slice(0, -1);\n  }\n  return pathname;\n}\n\n/** find the current route object through the path */\nexport function getCurrentRoute (\n  pathname = window.location.pathname,\n  routesMap: RoutesMapI\n) {\n  // console.log(routesMap);\n  // first look from the outermost routesMap\n  pathname = getValidPathname(pathname);\n  let currentRoute = routesMap[pathname];\n  // if can't find it, go to find to routesMap.__paramsRoutesMap\n  if (!currentRoute) {\n    const paths = Object.keys(routesMap.__paramsRoutesMap);\n    let pathIndex = 0;\n    while (!currentRoute && pathIndex < paths.length) {\n      const pathPattern = new RegExp(paths[pathIndex]);\n      if (pathname.match(pathPattern)) {\n        currentRoute = routesMap.__paramsRoutesMap[paths[pathIndex]];\n        break;\n      }\n      pathIndex = pathIndex + 1;\n    }\n  }\n  // TODO 找通配符的 后续优化\n  if (!currentRoute) {\n    // 有通配符的路径\n    const paths = routesMap.__flattenRoutes.map(i => i.path).filter(i => i.endsWith('*'));\n    // find the longest one\n    let longerPath = '';\n    paths.forEach(path => {\n      path = pathStartMarkTransform(path);\n      if (!pathname.startsWith(path)) {\n        return;\n      }\n      if (path in routesMap && path.length > longerPath.length) {\n        longerPath = path;\n      }\n      // 匹配 /a/b/c*\n      let _path = `${path}*`;\n      if (_path in routesMap && _path.length > longerPath.length) {\n        longerPath = _path;\n      }\n      // 匹配 /a/b/c/*\n      _path = `${path}/*`;\n\n      if (_path in routesMap && _path.length > longerPath.length) {\n        longerPath = _path;\n      }\n\n      // 匹配 /a/b/c*\n      _path = `${pathname}*`;\n      if (_path in routesMap && _path.length > longerPath.length) {\n        longerPath = _path;\n      }\n      // 匹配 /a/b/c/*\n      _path = `${pathname}/*`;\n\n      if (_path in routesMap && _path.length > longerPath.length) {\n        longerPath = _path;\n      }\n    });\n    if (longerPath) {\n      currentRoute = routesMap[longerPath];\n    }\n  }\n  // if (!currentRoute) {\n  //   // 找父级\n\n  // }\n  if (!currentRoute) {\n    // 默认404\n    currentRoute = {\n      name: '404',\n      path: pathname,\n      title: '404',\n      _isHasAuth: false,\n      _relativePath: '',\n      _level: 0,\n      meta: {},\n      component: () => {\n        return <NoAuth />;\n      },\n    };\n  }\n  return currentRoute;\n}\n\n/**\n * 获取路由的路径（父路由和子路由的集合，主要在导航中）\n * @param currentRoute\n * @returns\n */\nexport function getCurrentPathRoutes (currentRoute: RouteTypeExtendsI) {\n  const routes: RouteTypeExtendsI[] = [];\n  let pathRoute: RouteTypeExtendsI | undefined = currentRoute;\n  while (pathRoute) {\n    routes.unshift(pathRoute);\n    pathRoute = pathRoute.parent;\n  }\n  return routes;\n}\n\nexport function executeEventCbs (option: {\n  to?: RouteTypeExtendsI\n  from?: RouteTypeExtendsI\n  callbacks: RouteCbI[]\n  finish: () => void\n}) {\n  const { to, from, callbacks, finish } = option;\n  function executeNextCb (cbIndex = 0) {\n    const nextCb = callbacks[cbIndex];\n    if (!nextCb) {\n      return finish();\n    } else {\n      nextCb.fn(to, from, () => {\n        executeNextCb(cbIndex + 1);\n      });\n    }\n  }\n  if (callbacks.length === 0) {\n    finish();\n  } else {\n    executeNextCb(0);\n  }\n}\n\nfunction getIsHasAuthByStrCode (code: string, permissionList: PermissionListType) {\n  return permissionList.includes(code);\n}\n\nfunction getIsHasAuthByFnCode (code: FnCodeType, route: RouteTypeI) {\n  return code(route);\n}\n\nexport function getIsHasAuth ({ code, permissionList, hasAuth, route }: { code: CodeType; permissionList: PermissionListType; hasAuth: boolean; route: RouteTypeI }) {\n  if (!hasAuth) { // 未配置权限\n    return true;\n  }\n  if (!code) { // 未配置code默认有权限\n    return true;\n  }\n\n  if (Array.isArray(code)) {\n    if (code.length === 0) {\n      return true;\n    }\n    return code.some(_code => {\n      return getIsHasAuthByStrCode(_code, permissionList);\n    });\n  }\n\n  if (code instanceof Function) {\n    return !!(getIsHasAuthByFnCode(code, route));\n  }\n\n  return getIsHasAuthByStrCode(code, permissionList);\n}\n\nexport function computeRoutesConfig (config: {\n  routes: RouteTypeInputI[]\n  permissionList?: string[]\n  hasAuth: boolean\n  beforeEachMount?: BeforeEachMountI\n  parent?: RouteTypeExtendsI\n}): RouteTypeExtendsI[] {\n  const { routes, permissionList = [], hasAuth, beforeEachMount, parent } = config;\n  return routes.map(route => {\n    const {\n      component: Component,\n      path,\n      code = '',\n      children,\n      items,\n      beforeEnter,\n      redirect,\n      meta,\n      type,\n      ...other\n    } = route;\n    let _children: RouteTypeExtendsI[] = [];\n    let _items: RouteTypeExtendsI[] = [];\n    let CurrentComponent = Component;\n    const props = {} as RouteTypePropsI;\n    if (beforeEnter || beforeEachMount) {\n      CurrentComponent = GeneratorHookCom;\n      props.beforeEnter = beforeEnter;\n      props.beforeEachMount = beforeEachMount;\n      props.Component = Component;\n      props.key = route.name; // users switch between routes to avoid incorrect rendering due to the same key after route switching\n      props._route = route;\n    }\n    const isHasAuth = getIsHasAuth({ code, permissionList, hasAuth, route });\n\n    const newRoute: RouteTypeExtendsI = {\n      ...route,\n      parent,\n      props,\n      meta: meta || {},\n      items: [],\n      children: [],\n      _route: route,\n      _isHasAuth: isHasAuth,\n    };\n\n    if (!isHasAuth) {\n      /**\n       * if there is no permission, the children also has no permission\n       * /a/b/c 则加入 /a/b/c/*\n       */\n      let noAuthItems: RouteTypeExtendsI[] = [];\n      if (!path.endsWith('*')) {\n        const _path = path.endsWith('/') ? `${path}*` : `${path}/*`;\n        noAuthItems = [\n          {\n            meta: {},\n            name: getIncrementName(),\n            path: _path,\n            title: '',\n            hidden: true,\n            component: NoAuth,\n            _level: other._level + 1,\n            _route: route,\n            _component: NoAuth,\n            _relativePath: '*',\n          },\n        ];\n      }\n      const returnRoute = {\n        ...newRoute,\n        items: noAuthItems,\n        children: [],\n        _component: NoAuth,\n      };\n      noAuthItems.forEach(i => {\n        i.parent = returnRoute;\n      });\n      return returnRoute;\n    }\n\n    // 处理子路由\n    if (children) {\n      _children = computeRoutesConfig({\n        routes: children,\n        permissionList,\n        hasAuth,\n        beforeEachMount,\n        parent: newRoute,\n      });\n    }\n    // 处理同级路由\n    if (items) {\n      _items = computeRoutesConfig({\n        routes: items,\n        permissionList,\n        hasAuth,\n        beforeEachMount,\n        parent: newRoute,\n      });\n    }\n    const _itemsAndChildren = [..._items, ..._children];\n    if (redirect) {\n      return {\n        ...newRoute,\n        children: _children,\n        items: _items,\n        _component: () => <Navigate to={redirect} replace={true} />,\n        _itemsAndChildren,\n      };\n    }\n    if (type === 'null') {\n      return {\n        ...newRoute,\n        children: _children,\n        items: _items,\n        _component: undefined,\n        _itemsAndChildren,\n      };\n    }\n    if (Component) {\n      return {\n        ...newRoute,\n        children: _children,\n        items: _items,\n        _component: CurrentComponent,\n        _itemsAndChildren,\n      };\n    } else {\n      const redirectPath = handleRedirectPath(route, permissionList, hasAuth);\n      if (redirectPath) {\n        let replace = false;\n        // 父级也没配置component，则会进行多次重定向进行replace, 以便浏览器回退行为\n        if (!route.parent?.component) {\n          replace = true;\n        }\n        return {\n          ...newRoute,\n          children: _children,\n          items: _items,\n          _component: () => <Navigate to={redirectPath} replace={replace} />,\n          _itemsAndChildren,\n        };\n      }\n      return {\n        ...newRoute,\n        items: [],\n        children: [],\n        _component: NoAuth,\n      };\n    }\n  });\n}\n\nexport function getCurrentRouteCbsByEvent (\n  routeEvent: RouteEvent,\n  pathname: string,\n  routeHooks: RouteCbI[]\n): RouteCbI[] {\n  return routeHooks.filter(i => {\n    return i.name === routeEvent && i.pathname === pathname;\n  });\n}\n\nfunction pathStartMarkTransform (path: string) {\n  if (path === '/') {\n    return path;\n  }\n  return path.replace(/\\/*\\**$/gm, '');\n}\n\n/**\n * when jump route，Remove the '*'\n * @param to\n * @returns\n */\nexport function getRealTo (to: To): To {\n  if (typeof to === 'string') {\n    return pathStartMarkTransform(to);\n  }\n  const { pathname } = to;\n  if (pathname) {\n    return {\n      ...to,\n      pathname: pathStartMarkTransform(pathname),\n    };\n  }\n  return to;\n}\n\nexport const handleRedirectPath = (\n  route: RouteTypeInputI,\n  permissionList: string[],\n  hasAuth: boolean\n): string => {\n  // Return to the first menu(route) item with permission\n  const { items } = route;\n  if (!items) {\n    return '';\n  }\n  // No configuration permission, return to the first one child route\n  if (!hasAuth) {\n    return items[0].path;\n  }\n  let redirectPath = '';\n  // find the first one route with permission\n  for (let i = 0; i < items?.length; i++) {\n    const childRoute = items[i];\n    const { code, path } = childRoute;\n    if (!code) {\n      // if code is false, the default is permission\n      redirectPath = path;\n      break;\n    }\n\n    if (getIsHasAuth({ code, permissionList, hasAuth, route: childRoute })) {\n      redirectPath = path;\n      break;\n    }\n  }\n  return redirectPath;\n};\n\nexport function mixinNotFoundPage (\n  flattenRoutes: RouteTypeExtendsI[],\n  basename: string,\n  authInputRoutes: RouteTypeExtendsI[]\n) {\n  const notFoundPath = getWholePath('*', basename);\n  const hasNotFoundPage = flattenRoutes.some(({ path }) => {\n    if (path === notFoundPath) {\n      return true;\n    }\n    return false;\n  });\n  if (hasNotFoundPage) {\n    return;\n  }\n\n  const notFoundPage = {\n    name: 'notFound',\n    title: 'notFound',\n    meta: {},\n    path: notFoundPath,\n    component: NotFound,\n    _component: NotFound,\n    _relativePath: notFoundPath,\n    _level: 0,\n  };\n  authInputRoutes.push(notFoundPage);\n  flattenRoutes.push(notFoundPage);\n}\n\n// determine whether it is a react component\n// react Components are characterized by functions\n\nexport function isComponent (component: any): component is React.ComponentType<any> {\n  if (component instanceof Function) {\n    return true;\n  }\n  return false;\n}\n\nexport function isString (str: any): str is string {\n  if (typeof str === 'string') {\n    return true;\n  }\n  return false;\n}\n\n/**\n * 1、To support ts, users are prompted when writing code\n * 2、Modify global configuration\n * 3、Add '_isDefined' attribute, Used by MRouter to defined whether the object has been called defineRouterConfig\n * @param routerConfig\n * @returnsRouterBaseConfigI\n */\nlet _defineId = 0;\nexport function defineRouterConfig (routerConfig: RouterConfigI): RouterBaseConfigI {\n  const { LoadingComponent, ..._config } = routerConfig;\n  _defineId = _defineId + 1;\n  if (LoadingComponent) {\n    setChangeable({LoadingComponent})\n  }\n  /** add '_isDefined' attribute */\n  const config: RouterBaseConfigI = {..._config, _isDefined: true, _defineId: _defineId}\n  return config;\n}\n\ninterface ArrayLike<T> extends Array<T> {\n  readonly length: number\n  readonly [n: number]: T\n}\ntype Many<T> = T | ReadonlyArray<T>;\n\nexport function flattenArr<T> (ary: ArrayLike<Many<T>> | null | undefined): T[] {\n  if (!ary) {\n    return [];\n  }\n  return ary.reduce((pre: T[], cur) => {\n    return pre.concat(Array.isArray(cur) ? flattenArr(cur) : cur);\n  }, [] as T[]);\n}\n\n\n","import { NewStateI, NewStateQueryI } from \"./type\";\nimport { computedNewState } from \"./util\";\n\n// Initialized data to prevent double calculation\n// defineRouterConfig may be called multiple times in the same application\nlet initialStateMap = new Map<\n  number,\n  {\n    queryData: NewStateQueryI;\n    initialData: NewStateI;\n  }\n>();\n\nfunction getSameQueryData(\n  prevData: NewStateQueryI,\n  currentData: NewStateQueryI\n) {\n  return (\n    prevData.basename === currentData.basename &&\n    prevData.hasAuth === currentData.hasAuth &&\n    prevData.beforeEachMount === currentData.beforeEachMount &&\n    prevData.inputRoutes === currentData.inputRoutes && \n    prevData.permissionList === currentData.permissionList\n  );\n}\nfunction getInitialState(\n  currentQueryData: NewStateQueryI & { _defineId: number }\n): NewStateI {\n  const {\n    inputRoutes,\n    hasAuth,\n    permissionList,\n    beforeEachMount,\n    basename,\n    location,\n    _defineId\n  } = currentQueryData;\n  const prevData = initialStateMap.get(_defineId);\n  if (prevData) {\n    const isSameQueryData = getSameQueryData(\n      prevData.queryData,\n      currentQueryData\n    );\n    if (isSameQueryData) {\n      return prevData.initialData;\n    }\n  }\n  const _initialState = computedNewState({\n    inputRoutes,\n    permissionList,\n    hasAuth,\n    beforeEachMount,\n    basename,\n    location\n  });\n  initialStateMap.set(_defineId, {\n    queryData: currentQueryData,\n    initialData: _initialState\n  });\n  return _initialState;\n}\n\nexport default getInitialState;\n","import * as React from 'react';\nimport type { RouteHistoryObject } from '../type';\n\nconst MRouterHistoryContext = React.createContext<RouteHistoryObject>(null!);\nMRouterHistoryContext.displayName = 'MRouterHistoryContext';\n\nexport function useHistory () {\n  return React.useContext(MRouterHistoryContext).history;\n}\n\nexport function useRouteHooks () {\n  return React.useContext(MRouterHistoryContext).routeHooks;\n}\n\nexport function useRouteHooksRef () {\n  return React.useContext(MRouterHistoryContext).routeHooksRef;\n}\n\nexport function useHistoryMethods () {\n  return React.useContext(MRouterHistoryContext).historyMethods;\n}\n\nexport default MRouterHistoryContext;\n","import * as React from \"react\";\nimport { useMemo } from \"react\";\nimport { unstable_batchedUpdates } from \"react-dom\";\nimport type { BrowserRouterProps, Location } from \"react-router-dom\";\nimport { Router } from \"react-router-dom\";\nimport type { BrowserHistory } from \"@remix-run/router\";\nimport { createBrowserHistory } from \"@remix-run/router\";\nimport type { RouteCbI, RouteHistoryObject } from \"./type\";\nimport MRouterHistoryContext from \"./Context/MRouterHistoryContext\";\n\n/**\n * A `<Router>` for use in web browsers. Provides the cleanest URLs.\n */\nexport default function BrowserRouter({\n  basename,\n  children,\n  syncUpdateCurrentRoute\n}: BrowserRouterProps & {\n  syncUpdateCurrentRoute: (location: Location) => void;\n}) {\n  const historyRef = React.useRef<BrowserHistory>(null!);\n  const routeHooksRef = React.useRef<RouteCbI[]>(null!);\n  if (historyRef.current == null) {\n    historyRef.current = createBrowserHistory({ window });\n    routeHooksRef.current = [];\n  }\n\n  const historyContext = useMemo(() => {\n    return {\n      history: historyRef.current as BrowserHistory,\n      routeHooks: routeHooksRef.current as RouteCbI[],\n      routeHooksRef,\n      historyMethods: {\n        push: historyRef.current.push,\n        replace: historyRef.current.replace,\n        go: historyRef.current.go\n      }\n    } as RouteHistoryObject;\n  }, []);\n\n  const history = historyRef.current;\n\n  const [state, setState] = React.useState({\n    action: history.action,\n    location: history.location\n  });\n\n  React.useLayoutEffect(() => {\n    let mounted = true;\n    history.listen(routeData => {\n      const { location } = routeData;\n      if (!mounted) {\n        return;\n      }\n      unstable_batchedUpdates(() => {\n        setState(routeData);\n        syncUpdateCurrentRoute(location);\n      });\n    });\n    return () => {\n      mounted = false;\n    };\n  }, [history, syncUpdateCurrentRoute]);\n  return (\n    <MRouterHistoryContext.Provider value={historyContext}>\n      <Router\n        basename={basename}\n        location={state.location}\n        navigationType={state.action}\n        navigator={history}\n      >\n        {children}\n      </Router>\n    </MRouterHistoryContext.Provider>\n  );\n}\n","import * as React from \"react\";\nimport { useMemo } from \"react\";\nimport { unstable_batchedUpdates } from \"react-dom\";\nimport type { BrowserRouterProps, Location } from \"react-router-dom\";\nimport { Router } from \"react-router-dom\";\nimport { HashHistory, createHashHistory } from \"@remix-run/router\";\nimport type { RouteCbI, RouteHistoryObject } from \"./type\";\nimport MRouterHistoryContext from \"./Context/MRouterHistoryContext\";\n\n/**\n * A `<Router>` for use in web browsers. Provides the cleanest URLs.\n */\nexport default function HashRouter({\n  basename,\n  children,\n  syncUpdateCurrentRoute\n}: BrowserRouterProps & {\n  syncUpdateCurrentRoute: (location: Location) => void;\n}) {\n  const historyRef = React.useRef<HashHistory>(null!);\n  const routeHooksRef = React.useRef<RouteCbI[]>(null!);\n  if (historyRef.current == null) {\n    historyRef.current = createHashHistory({ window });\n    routeHooksRef.current = [];\n  }\n  const historyContext = useMemo(() => {\n    return {\n      history: historyRef.current as HashHistory,\n      routeHooks: routeHooksRef.current as RouteCbI[],\n      routeHooksRef,\n      historyMethods: {\n        push: historyRef.current.push,\n        replace: historyRef.current.replace,\n        go: historyRef.current.go\n      }\n    } as RouteHistoryObject;\n  }, []);\n\n  const history = historyRef.current;\n\n  const [state, setState] = React.useState({\n    action: history.action,\n    location: history.location\n  });\n\n  React.useLayoutEffect(() => {\n    let mounted = true;\n    history.listen(routeData => {\n      const { location } = routeData;\n      if (!mounted) {\n        return;\n      }\n      unstable_batchedUpdates(() => {\n        setState(routeData);\n        syncUpdateCurrentRoute(location);\n      });\n    });\n    return () => {\n      mounted = false;\n    };\n  }, [history, syncUpdateCurrentRoute]);\n  return (\n    <MRouterHistoryContext.Provider value={historyContext}>\n      <Router\n        basename={basename}\n        location={state.location}\n        navigationType={state.action}\n        navigator={history}\n      >\n        {children}\n      </Router>\n    </MRouterHistoryContext.Provider>\n  );\n}\n","import type { NavigateOptions, To } from \"react-router-dom\";\nimport type { ParsedQuery } from \"query-string\";\nimport type { BrowserHistory, Location } from \"history\";\nimport * as React from \"react\";\n\nexport interface RouterBaseConfigI {\n  routes: RouteTypeI[];\n  basename?: string;\n  beforeEachMount?: BeforeEachMountI;\n  // the title of the document changes depending on the route switch\n  autoDocumentTitle?:\n    | boolean\n    | ((currentPathRoutes: RouteTypeExtendsI[]) => string);\n  _isDefined: boolean; // 是否是defined的\n  _defineId: number;\n}\n\nexport interface RouterConfigI extends Omit<RouterBaseConfigI, \"_isDefined\"> {\n  /** Lazy component or before next called */\n  LoadingComponent?: React.FunctionComponent<any>;\n  // beforeEachEnter?: BeforeEachEnterI;\n}\n\nexport type PermissionListType = string[];\nexport type CodeType = string | string[] | FnCodeType;\nexport type FnCodeType = (route: RouteTypeI) => boolean;\n\nexport type NextOptionsType =\n  | {\n      name?: string; // if name is configured, it will jump to the route corresponding to the route configuration\n      path?: string; // path\n    }\n  | React.ComponentType<any>; // iff a component is configured, it will be rendered\n\n// global route entry hook\nexport interface BeforeEachMountI {\n  (to: RouteTypeI, next: (nextOptionsType?: NextOptionsType) => void): void;\n}\n\nexport interface BeforeEachEnterI {\n  (to: RouteTypeI, next: (nextOptionsType?: NextOptionsType) => void): void;\n}\n\nexport enum RouteNavTypeEnum {\n  menu,\n  step\n}\nexport interface BeforeEnterI {\n  (\n    to: RouteTypeI | undefined,\n    next: (nextOptionsType?: NextOptionsType) => void\n  ): void;\n}\n\nexport interface BeforeLeaveI {\n  (\n    to: RouteTypeI | undefined,\n    from: RouteTypeI | undefined,\n    next: (ReplaceComponent?: any) => void\n  ): void;\n}\nexport interface RouteTypePropsI {\n  beforeEachMount?: BeforeEachMountI;\n  beforeEnter?: BeforeEnterI;\n  [prop: string]: any;\n}\n\nexport type RouteComponentType = React.LazyExoticComponent<any> | React.FC<any>;\nexport interface RouteTypeI {\n  name: string;\n  path: string;\n  component?: RouteComponentType;\n\n  beforeEnter?: BeforeEnterI;\n  beforeLeave?: BeforeLeaveI;\n  items?: RouteTypeI[]; // same level route\n  children?: RouteTypeI[]; // sub route of multi-level route, such as level-2 route under level-1 route\n  title?: string;\n  hidden?: boolean;\n  icon?: string;\n  code?: CodeType; // each menu item has a code, and the route code of the same menu item is the same\n  parentName?: string; // parent route name\n  fullscreen?: boolean; // if is true, the navigation bar will be hidden\n  props?: RouteTypePropsI;\n  redirect?: string;\n  type?: \"real\" | \"null\";\n\n  meta?: Record<string, any>; // some other information can be customized\n}\n\nexport interface RouteTypeInputI extends RouteTypeI {\n  _relativePath: string;\n  _level: number;\n  items?: RouteTypeInputI[];\n  children?: RouteTypeInputI[];\n  parent?: RouteTypeInputI;\n}\n\nexport interface RouteTypeExtendsI extends RouteTypeInputI {\n  parent?: RouteTypeExtendsI; // parent route name\n\n  meta: Record<string, any>; // some other information can be customized\n  items?: RouteTypeExtendsI[];\n  children?: RouteTypeExtendsI[];\n  _route?: RouteTypeInputI;\n  _component?: RouteComponentType;\n  _isHasAuth?: boolean; // true has permission; false: no permission\n  _itemsAndChildren?: RouteTypeExtendsI[];\n}\n\nexport enum RouterActionEnum {\n  UPDATE_INPUT_ROUTES = \"UPDATE_INPUT_ROUTES\",\n  UPDATE_CURRENT_ROUTE = \"UPDATE_CURRENT_ROUTE\",\n  UPDATE_STATE = \"UPDATE_STATE\",\n  ADD_ROUTES = \"ADD_ROUTES\",\n  REMOVE_ROUTES = \"REMOVE_ROUTES\",\n  UPDATE_ROUTES = \"UPDATE_ROUTES\"\n}\nexport interface Action {\n  type: RouterActionEnum;\n  payload?: any;\n  dispatch?: React.Dispatch<Action>;\n}\n\nexport interface MRouterStateI {\n  basename: string;\n\n  inputRoutes: RouteTypeInputI[];\n  authInputRoutes: RouteTypeExtendsI[];\n\n  routesMap: RoutesMapI;\n  flattenRoutes: RouteTypeExtendsI[];\n  currentRoute: RouteTypeExtendsI;\n  currentPathRoutes: RouteTypeExtendsI[];\n  prevRoute?: RouteTypeExtendsI;\n  permissionList?: string[];\n  hasAuth?: boolean;\n\n  beforeEachMount?: BeforeEachMountI;\n\n  _getNewStateByNewInputRoutes: (\n    _inputRoutes: RouteTypeInputI[]\n  ) => NewStateI;\n}\n\nexport interface AddRoutesI {\n  (routes: RouteTypeI[]): void;\n}\nexport interface RemoveRoutesI {\n  (routeNames: string[]): void;\n}\nexport interface UpdateRoutesI {\n  (routes: { routeName: string; routeData: Partial<RouteTypeI> }[]): void;\n}\nexport interface MRouterMethodsI {\n  addRoutes: AddRoutesI;\n  updateCurrentRoute: (currentRoute: RouteTypeExtendsI) => void;\n  removeRoutes: RemoveRoutesI;\n  updateRoutes: UpdateRoutesI;\n  // getStateByInputRoutes: (inputRoutes: RouteTypeInputI[]) => NewStateI;\n  [method: string]: any;\n}\nexport interface MRouterContextObject {\n  state: MRouterStateI;\n  // Some operation methods\n  methods: MRouterMethodsI;\n}\n\nexport interface RoutesBaseStateStruct {\n  routesMap: RoutesMapI;\n  routes: RouteTypeI[];\n  // flat routing\n  flattenRoutes: RouteTypeI[];\n  basename?: string;\n}\nexport interface ExtraNavigateOptions extends NavigateOptions {\n  params?: Record<string, any>; // url parameters of the route, for example: id\n  query?: Record<string, any>; // url query\n}\nexport interface NavigateFunction {\n  (to: To, options?: ExtraNavigateOptions): void;\n  (delta: number): void;\n}\nexport interface RoutesStateStruct extends RoutesBaseStateStruct {\n  navigate: NavigateFunction;\n  location: Location;\n  currentRoute: RouteTypeExtendsI;\n  authRoutes: RouteTypeExtendsI[];\n  query: ParsedQuery<string>;\n  params: Record<string, number | string>;\n}\n\nexport type RouteEvent = \"BeforeRouterLeave\" | \"AfterRouterEnter\";\n\nexport interface RouteCbI {\n  fn: BeforeLeaveI;\n  name: RouteEvent;\n  pathname: string;\n}\n\nexport interface RouteConfig {\n  path: string;\n  element?: React.ReactNode;\n  children?: RouteConfig[];\n}\n\nexport interface RouteHistoryObject {\n  history: BrowserHistory;\n  historyMethods: {\n    push(to: To, state?: any): void;\n    replace(to: To, state?: any): void;\n    go(delta: number): void;\n    back(): void;\n    forward(): void;\n  };\n  routeHooks: RouteCbI[];\n  routeHooksRef: React.MutableRefObject<RouteCbI[]>;\n}\nexport interface BaseRoutesMapI extends Record<string, RouteTypeExtendsI> {}\n\nexport type RoutesMapI = BaseRoutesMapI & {\n  __paramsRoutesMap: Record<string, RouteTypeExtendsI>;\n  __flattenRoutes: RouteTypeExtendsI[];\n};\n\nexport interface NewStateQueryI {\n  inputRoutes: RouteTypeInputI[];\n  permissionList?: string[];\n  hasAuth: boolean;\n  beforeEachMount?: BeforeEachMountI;\n  basename: string;\n  location: Location;\n}\n\nexport interface NewStateI {\n  authInputRoutes: RouteTypeExtendsI[];\n  flattenRoutes: RouteTypeExtendsI[];\n  routesMap: RoutesMapI;\n  currentRoute: RouteTypeExtendsI;\n  currentPathRoutes: RouteTypeExtendsI[];\n  beforeEachMount?: BeforeEachMountI | undefined;\n}\n","import type {\n  RouteTypeI,\n  MRouterStateI,\n  RouteTypeInputI,\n} from \"./type\";\nimport { cloneRoutes, computedNewState } from \"./util\";\n\nfunction newInputRoutesState(inputRoutes?: RouteTypeInputI[]): {\n  inputRoutes: RouteTypeInputI[];\n  routesMap: Record<string, RouteTypeInputI>;\n} {\n  const routesMap: Record<string, RouteTypeInputI> = {};\n  function _cloneInputRoutes(\n    inputRoutes?: RouteTypeInputI[],\n    parent?: RouteTypeInputI\n  ): RouteTypeInputI[] {\n    if (!inputRoutes) {\n      return [];\n    }\n    return inputRoutes.map(i => {\n      const _route: RouteTypeInputI = {\n        ...i,\n        items: [],\n        children: [],\n        parent: parent\n      };\n      _route.items = _cloneInputRoutes(i.items, _route);\n      _route.children = _cloneInputRoutes(i.children, _route);\n      routesMap[i.name] = _route;\n      return _route;\n    }, []);\n  }\n  return {\n    inputRoutes: _cloneInputRoutes(inputRoutes),\n    routesMap: routesMap\n  };\n}\n\n/**\n * add routes operation\n * @param state MRouterStateI\n * @param payload RouteTypeI[]\n * @returns MRouterStateI\n */\nexport function addRoutesAction(\n  state: MRouterStateI,\n  payload: any\n): MRouterStateI {\n  let hasChange = false;\n  const newRoutes = payload as RouteTypeI[];\n  const { routesMap, inputRoutes } = newInputRoutesState(state.inputRoutes);\n\n  newRoutes.forEach(_route => {\n    const { path, name, parentName } = _route;\n\n    if (routesMap[path] || routesMap[name]) {\n      throw new Error(`新增路由 ${name} ${path} 已经存在，请修改`);\n    }\n\n    if (parentName) {\n      const _parentRoute = routesMap[parentName];\n      if (_parentRoute) {\n        const route = cloneRoutes({\n          routes: [_route],\n          parent: _parentRoute,\n          _level: _parentRoute._level! + 1\n        });\n        _parentRoute.items = _parentRoute.items || [];\n        _parentRoute.items.push(route[0]);\n        hasChange = true;\n      }\n    } else {\n      // 根路径插入\n      const route = cloneRoutes({\n        routes: [_route],\n        _level: 0\n      });\n      inputRoutes.push(route[0]);\n      hasChange = true;\n    }\n  });\n  if (hasChange) {\n    const newState = state._getNewStateByNewInputRoutes(inputRoutes);\n\n    return {\n      ...state,\n      ...newState,\n      inputRoutes: [...inputRoutes]\n    };\n  }\n  return state;\n}\n/**\n * update routes operation\n * @param state MRouterStateI\n * @param payload RouteTypeI[]\n * @returns MRouterStateI\n */\nexport function updateRoutesAction(\n  state: MRouterStateI,\n  payload: any\n): MRouterStateI {\n  let hasChange = false;\n  // const { basename } = state;\n  const newRoutesPayload = payload as {\n    routeName: string;\n    routeData: Partial<RouteTypeI>;\n  }[];\n  const { routesMap, inputRoutes } = newInputRoutesState(state.inputRoutes);\n  newRoutesPayload.forEach(({ routeName, routeData }) => {\n    const route = routesMap[routeName];\n    if (route) {\n      // 如果parent存在，则不是根节点\n      const parent = route.parent;\n\n      const _newRouteData = {\n        ...route,\n        ...routeData\n      };\n\n      const newRouteData = cloneRoutes({\n        routes: [_newRouteData],\n        parent,\n        _level: (parent?._level || 0) + 1,\n        basename: state.basename\n      });\n\n      if (!parent) {\n        Object.assign(route, newRouteData[0]);\n        hasChange = true;\n      }\n      if (parent && parent.items) {\n        parent.items.splice(parent.items.indexOf(route), 1, newRouteData[0]);\n        hasChange = true;\n      } else if (parent && parent.children) {\n        parent.children.splice(\n          parent.children.indexOf(route),\n          1,\n          newRouteData[0]\n        );\n        hasChange = true;\n      }\n    }\n  });\n\n  if (hasChange) {\n    const newState = state._getNewStateByNewInputRoutes(inputRoutes);\n    return {\n      ...state,\n      ...newState,\n      inputRoutes: [...inputRoutes]\n    };\n  }\n  return state;\n}\n/**\n * remove routes operation\n * @param state MRouterStateI\n * @param payload RouteTypeI[]\n * @returns MRouterStateI\n */\nexport function removeRoutesAction(\n  state: MRouterStateI,\n  payload: any\n): MRouterStateI {\n  let hasChange = false;\n  const routeNames = payload as string[];\n  const { routesMap, inputRoutes } = newInputRoutesState(state.inputRoutes);\n  routeNames.forEach(routeName => {\n    const _route = routesMap[routeName];\n    if (_route) {\n      // 如果parent存在，则不是根节点\n      const parent = _route.parent;\n      if (!parent) {\n        const index = inputRoutes.indexOf(_route);\n        if (index > -1) {\n          inputRoutes.splice(index, 1);\n          hasChange = true;\n        }\n      }\n      if (parent && parent.items) {\n        const index = parent.items.indexOf(_route);\n        if (index > -1) {\n          parent.items.splice(index, 1);\n          hasChange = true;\n        }\n      }\n    }\n  });\n  if (hasChange) {\n    const newState = state._getNewStateByNewInputRoutes(inputRoutes);\n    return {\n      ...state,\n      ...newState,\n      inputRoutes: [...inputRoutes]\n    };\n  } else {\n    return state;\n  }\n}\n","import * as React from 'react';\nimport { addRoutesAction, removeRoutesAction, updateRoutesAction } from '../actions';\nimport type {\n  Action,\n  AddRoutesI,\n  RoutesMapI,\n  UpdateRoutesI,\n  MRouterContextObject,\n  MRouterStateI,\n} from '../type';\nimport {\n  RouterActionEnum\n} from '../type';\n\nconst MRouterContext = React.createContext<MRouterContextObject>({\n  state: {\n    inputRoutes: [],\n    authInputRoutes: [],\n    permissionList: [],\n    routesMap: {} as RoutesMapI,\n    flattenRoutes: [],\n  },\n  methods: {},\n} as unknown as MRouterContextObject);\nMRouterContext.displayName = 'MRouterContext';\n\nexport function MRouterReducer (state: MRouterStateI, action: Action): MRouterStateI {\n  const { type, payload } = action;\n  switch (type) {\n    case RouterActionEnum.ADD_ROUTES: {\n      return addRoutesAction(state, payload);\n    }\n    case RouterActionEnum.REMOVE_ROUTES: {\n      return removeRoutesAction(state, payload);\n    }\n    case RouterActionEnum.UPDATE_ROUTES: {\n      return updateRoutesAction(state, payload);\n    }\n    case RouterActionEnum.UPDATE_INPUT_ROUTES: {\n      return {\n        ...state,\n        inputRoutes: payload,\n      };\n    }\n    case RouterActionEnum.UPDATE_CURRENT_ROUTE: {\n      return {\n        ...state,\n        currentRoute: payload,\n      };\n    }\n    case RouterActionEnum.UPDATE_STATE: {\n      return {\n        ...state,\n        ...payload,\n      };\n    }\n    default: {\n      return { ...state };\n    }\n  }\n}\n\nexport function useRouterState (): MRouterStateI {\n  return React.useContext(MRouterContext).state;\n}\n\n/** Dynamically add routing method */\nexport function useAddRoutes (): AddRoutesI {\n  return React.useContext(MRouterContext).methods.addRoutes;\n}\n\nexport function useRemoveRoutes (): (routeNames: string[]) => void {\n  return React.useContext(MRouterContext).methods.removeRoutes;\n}\n\nexport function useUpdateRoutes (): UpdateRoutesI {\n  return React.useContext(MRouterContext).methods.updateRoutes;\n}\n\nexport default MRouterContext;\n","import * as React from 'react';\nimport {\n  Suspense,\n  useCallback,\n  useEffect,\n  useImperativeHandle,\n  useLayoutEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState\n} from \"react\";\nimport type { Location, To } from \"react-router-dom\";\nimport {\n  generatePath,\n  useLocation,\n  useNavigate as useOldNavigate,\n  useParams,\n  useRoutes\n} from \"react-router\";\nimport { parse, stringify } from \"query-string\";\n\nimport {\n  cloneRoutes,\n  computedNewState,\n  executeEventCbs,\n  flattenArr,\n  getCurrentPathRoutes,\n  getCurrentRoute,\n  getCurrentRouteCbsByEvent,\n  getRealTo\n} from \"./util\";\nimport getInitialState from \"./getInitialState\";\nimport BrowserRouter from \"./BrowserRouter\";\nimport HashRouter from \"./HashRouter\";\nimport type {\n  BeforeLeaveI,\n  ExtraNavigateOptions,\n  RouteCbI,\n  RouteConfig,\n  RouteTypeExtendsI,\n  RouteTypeI,\n  RoutesMapI,\n  RoutesStateStruct,\n  RouterBaseConfigI,\n  RouteTypeInputI,\n  NewStateI\n} from \"./type\";\nimport { RouterActionEnum } from \"./type\";\nimport MRouterContext, {\n  MRouterReducer,\n  useAddRoutes,\n  useRemoveRoutes,\n  useRouterState,\n  useUpdateRoutes\n} from \"./Context/MRouterContext\";\nimport {\n  useHistory,\n  useHistoryMethods,\n  useRouteHooksRef\n} from \"./Context/MRouterHistoryContext\";\nimport { changeable } from \"./changeable\";\n\nexport type { RouterConfigI, RouteTypeI, RouteTypeExtendsI } from \"./type\";\n\nexport { defineRouterConfig } from \"./util\";\n\nconst DEFAULT_PERMISSION_LIST: string[] = [];\n\nfunction useBeforeLeave(fn: BeforeLeaveI): void {\n  const pathname = window.location.pathname;\n  const routeHooksRef = useRouteHooksRef();\n  useLayoutEffect(() => {\n    const hooks = routeHooksRef.current;\n    const routeHook = {\n      name: \"BeforeRouterLeave\",\n      pathname,\n      fn\n    } as RouteCbI;\n    hooks.push(routeHook);\n    return () => {\n      const index = hooks.indexOf(routeHook);\n      hooks.splice(index, 1);\n    };\n  }, [fn, pathname, routeHooksRef]);\n}\nexport interface NavigateFunction {\n  (to: To, options?: ExtraNavigateOptions): void;\n  (delta: number): void;\n}\n\nconst useNavigate = (): NavigateFunction => {\n  const oldNavigate = useOldNavigate();\n  const newCallback = useCallback(\n    (to, options: ExtraNavigateOptions = {}) => {\n      if (options?.params && typeof to === \"string\") {\n        to = generatePath(to, options.params);\n      }\n      // query写入地址栏\n      if (options?.query && typeof to === \"string\") {\n        let path = to;\n        const queryStr = stringify(options.query);\n        if (path.includes(\"?\")) {\n          path = `${path}&${queryStr}`;\n        } else {\n          path = `${path}?${queryStr}`;\n        }\n        to = path;\n      }\n\n      return oldNavigate(to, options);\n    },\n    [oldNavigate]\n  );\n  return newCallback;\n};\n\nfunction useRouter(): RoutesStateStruct {\n  const location = useLocation();\n  const routesMapRef = useRef<RoutesMapI>({} as RoutesMapI);\n  const {\n    routesMap,\n    inputRoutes,\n    currentRoute,\n    flattenRoutes,\n    authInputRoutes,\n    basename\n  } = useRouterState();\n\n  if (routesMapRef.current !== routesMap) {\n    routesMapRef.current = routesMap;\n  }\n\n  const search = useMemo(() => {\n    return parse(location.search);\n  }, [location.search]);\n\n  const routerParams = useParams();\n\n  const newNavigate = useNavigate();\n\n  return {\n    navigate: newNavigate,\n    routesMap,\n    query: search,\n    params: routerParams as Record<string, string | number>,\n    routes: inputRoutes,\n    authRoutes: authInputRoutes,\n    currentRoute,\n    flattenRoutes,\n    location,\n    basename\n  };\n}\n\ninterface MRouterContextProviderI {\n  permissionList?: string[];\n  hasAuth: boolean;\n  routerConfig: RouterBaseConfigI;\n  children?: (children: React.ReactNode) => React.ReactNode;\n}\n\ninterface InternalMRouterContextProviderRef {\n  updateCurrentRoute: (location: Location) => void;\n}\n\nconst InternalMRouterContextProvider: React.ForwardRefRenderFunction<\n  InternalMRouterContextProviderRef,\n  MRouterContextProviderI\n> = (\n  { permissionList = DEFAULT_PERMISSION_LIST, routerConfig, hasAuth, children },\n  ref\n) => {\n  const history = useHistory();\n  const location = useLocation();\n  const locationRef = useRef(location);\n\n  const oldHistoryMethods = useHistoryMethods();\n  const routeHooksRef = useRouteHooksRef();\n\n  const {\n    routes = [],\n    basename = \"/\",\n    beforeEachMount,\n    autoDocumentTitle = false\n  } = routerConfig;\n\n  const inputRoutes = useMemo(() => {\n    return cloneRoutes({\n      routes,\n      basename\n    });\n  }, [basename, routes]);\n\n  const inputRoutesRef = useRef(inputRoutes);\n\n  const [initialState] = useState(\n    getInitialState({\n      inputRoutes,\n      permissionList,\n      hasAuth,\n      beforeEachMount,\n      basename,\n      location: locationRef.current,\n      _defineId: routerConfig._defineId\n    })\n  );\n\n  const getNewStateByNewInputRoutesRef = useRef<\n    (_inputRoutes: RouteTypeInputI[]) => NewStateI\n  >(null!);\n  const _getNewStateByNewInputRoutes = useCallback(\n    (_inputRoutes: RouteTypeInputI[]) => {\n      return computedNewState({\n        inputRoutes: _inputRoutes,\n        permissionList,\n        hasAuth,\n        beforeEachMount,\n        basename,\n        location: location\n      });\n    },\n    [basename, beforeEachMount, hasAuth, location, permissionList]\n  );\n  getNewStateByNewInputRoutesRef.current = _getNewStateByNewInputRoutes;\n\n  // initialization\n  const [state, dispatch] = useReducer(MRouterReducer, {\n    ...initialState,\n    inputRoutes,\n    permissionList,\n    hasAuth,\n    basename,\n    _getNewStateByNewInputRoutes: getNewStateByNewInputRoutesRef.current\n  });\n\n  /**\n   * listen router change，set currentRoute\n   *  Put the updated currentRoute in history listen updates in batches to reduce the number of updates\n   */\n  useImperativeHandle(ref, () => {\n    return {\n      updateCurrentRoute(location) {\n        const { pathname } = location;\n        const prevRoute = state.currentRoute;\n        const currentRoute = getCurrentRoute(pathname, state.routesMap);\n\n        let currentPathRoutes = state.currentPathRoutes;\n        if (currentRoute !== state.currentRoute) {\n          currentPathRoutes = getCurrentPathRoutes(currentRoute);\n        }\n        dispatch({\n          type: RouterActionEnum.UPDATE_STATE,\n          payload: {\n            currentRoute,\n            currentPathRoutes,\n            prevRoute\n          }\n        });\n      }\n    };\n  });\n\n  useLayoutEffect(() => {\n    // filter routes without permission\n    // used to judge initialization or update. If they are equal, only currentRoute needs to be calculated\n    if (\n      state.permissionList === permissionList &&\n      hasAuth === state.hasAuth &&\n      state.inputRoutes === inputRoutes &&\n      state.beforeEachMount === beforeEachMount\n    ) {\n      return;\n    }\n    // if inputRoutes change, the incoming inputRoutes shall prevail\n    let _inputRoutes = state.inputRoutes;\n    if (\n      inputRoutesRef.current === inputRoutes &&\n      state.permissionList === permissionList &&\n      hasAuth === state.hasAuth &&\n      state.beforeEachMount === beforeEachMount\n    ) {\n      // Equal, indicating that state.inputRoutes has changed, is add remove and update routes\n      return;\n    } else {\n      // if not Equal, record the value of inputRoutes for next comparison\n      inputRoutesRef.current = inputRoutes;\n      _inputRoutes = inputRoutes;\n    }\n\n    const {\n      authInputRoutes,\n      flattenRoutes,\n      routesMap,\n      currentRoute,\n      currentPathRoutes\n    } = computedNewState({\n      inputRoutes: _inputRoutes,\n      permissionList,\n      hasAuth,\n      beforeEachMount,\n      basename,\n      location\n    });\n\n    dispatch({\n      type: RouterActionEnum.UPDATE_STATE,\n      payload: {\n        permissionList,\n        authInputRoutes,\n        routesMap,\n        flattenRoutes,\n        currentRoute,\n        currentPathRoutes,\n        basename,\n        beforeEachMount\n      }\n    });\n  }, [\n    state.inputRoutes,\n    inputRoutes,\n    permissionList,\n    state.permissionList,\n    hasAuth,\n    state.hasAuth,\n    basename,\n    beforeEachMount,\n    location\n  ]);\n\n  // auto setting document.title\n  useEffect(() => {\n    if (!autoDocumentTitle) {\n      return;\n    }\n    let title = \"\";\n    if (typeof autoDocumentTitle === \"boolean\") {\n      title = state.currentPathRoutes\n        .map(i => {\n          return i.title;\n        })\n        .join(\"-\");\n    } else if (typeof autoDocumentTitle === \"function\") {\n      title = autoDocumentTitle(state.currentPathRoutes);\n    }\n    document.title = title;\n  }, [autoDocumentTitle, state.currentPathRoutes]);\n\n  const allExecuteEventCbs = useCallback(\n    (historyCb: () => void, to?: To) => {\n      if (typeof to !== \"string\") {\n        to = to?.pathname;\n      }\n      const pathname = window.location.pathname;\n      const beforeRouterLeaveCbs = getCurrentRouteCbsByEvent(\n        \"BeforeRouterLeave\",\n        pathname,\n        routeHooksRef.current\n      );\n      if (state.currentRoute?.beforeLeave) {\n        beforeRouterLeaveCbs.unshift({\n          name: \"BeforeRouterLeave\",\n          pathname: state.currentRoute.path,\n          fn: state.currentRoute.beforeLeave as BeforeLeaveI\n        });\n      }\n      if (beforeRouterLeaveCbs.length) {\n        executeEventCbs({\n          to: getCurrentRoute(to as string, state.routesMap),\n          from: getCurrentRoute(pathname, state.routesMap),\n          callbacks: beforeRouterLeaveCbs,\n          finish: () => {\n            return historyCb();\n          }\n        });\n      } else {\n        return historyCb();\n      }\n    },\n    [\n      routeHooksRef,\n      state.currentRoute.beforeLeave,\n      state.currentRoute.path,\n      state.routesMap\n    ]\n  );\n\n  useLayoutEffect(() => {\n    // Intercept the methods used in history in useNavigator\n    history.go = (delta: number) => {\n      allExecuteEventCbs(() => {\n        const res = oldHistoryMethods.go(delta);\n        // history.go = oldHistoryMethods.go;\n        return res;\n      });\n    };\n    history.push = (to: To, state?: any) => {\n      to = getRealTo(to);\n      allExecuteEventCbs(() => {\n        const res = oldHistoryMethods.push(to, state);\n        // history.push = oldHistoryMethods.push;\n        return res;\n      }, to);\n    };\n\n    history.replace = (to: To, state?: any) => {\n      to = getRealTo(to);\n      allExecuteEventCbs(() => {\n        const res = oldHistoryMethods.replace(to, state);\n        // history.replace = oldHistoryMethods.replace;\n        return res;\n      }, to);\n    };\n\n    history.back = () => {\n      allExecuteEventCbs(() => {\n        const res = oldHistoryMethods.back();\n        // history.back = oldHistoryMethods.back;\n        return res;\n      });\n    };\n\n    history.forward = () => {\n      allExecuteEventCbs(() => {\n        const res = oldHistoryMethods.forward();\n        // history.forward = oldHistoryMethods.forward;\n        return res;\n      });\n    };\n  }, [allExecuteEventCbs, history, oldHistoryMethods]);\n\n  const addRoutes = useCallback((newRoutes: RouteTypeI[]) => {\n    dispatch({\n      type: RouterActionEnum.ADD_ROUTES,\n      payload: newRoutes\n    });\n  }, []);\n\n  const removeRoutes = useCallback((routeNames: string[]) => {\n    dispatch({\n      type: RouterActionEnum.REMOVE_ROUTES,\n      payload: routeNames\n    });\n  }, []);\n\n  const updateRoutes = useCallback(\n    (routes: { routeName: string; routeData: Partial<RouteTypeI> }[]) => {\n      dispatch({\n        type: RouterActionEnum.UPDATE_ROUTES,\n        payload: routes\n      });\n    },\n    []\n  );\n\n  const updateCurrentRoute = useCallback((currentRoute: RouteTypeExtendsI) => {\n    if (!currentRoute) {\n      return;\n    }\n    dispatch({\n      type: RouterActionEnum.UPDATE_CURRENT_ROUTE,\n      payload: currentRoute\n    });\n  }, []);\n\n  const routesConfig = useMemo(() => {\n    function _computeRoutesConfig(routes: RouteTypeExtendsI[]) {\n      const _routes = routes.map(route => {\n        let _routeConfig: RouteConfig | undefined;\n        let _itemsRouteConfig: RouteConfig[] = [];\n        const {\n          _component: Component,\n          path,\n          items,\n          children,\n          _isHasAuth,\n          props\n        } = route;\n        if (Component) {\n          const LoadingCmp = changeable.LoadingComponent;\n          if (!_isHasAuth) {\n            /** Without permission, the child also has no permission */\n            return {\n              path: path.endsWith(\"*\") ? path : `${path}/*`,\n              element: (\n                <Suspense fallback={<LoadingCmp />}>\n                  <Component {...props} />\n                </Suspense>\n              )\n            } as RouteConfig;\n          }\n          _routeConfig = {\n            path,\n            element: (\n              <Suspense fallback={LoadingCmp}>\n                <Component {...props} />\n              </Suspense>\n            )\n          } as RouteConfig;\n          if (children) {\n            _routeConfig.children = _computeRoutesConfig(children);\n          }\n          if (items) {\n            _itemsRouteConfig = _computeRoutesConfig(items);\n          }\n        }\n\n        const nextRoutes = [_routeConfig, ..._itemsRouteConfig].filter(i => {\n          return i !== undefined;\n        }) as RouteConfig[];\n        return nextRoutes;\n      });\n      return flattenArr(_routes);\n    }\n    const _routesConfig = _computeRoutesConfig(state.authInputRoutes);\n    return _routesConfig;\n  }, [state.authInputRoutes]);\n\n  const routesChildren = useRoutes(routesConfig);\n\n  const renders = useMemo(() => {\n    return children ? children(routesChildren) : routesChildren;\n  }, [children, routesChildren]);\n\n  return (\n    <MRouterContext.Provider\n      value={{\n        state,\n        methods: {\n          addRoutes,\n          updateCurrentRoute,\n          removeRoutes,\n          updateRoutes\n        }\n      }}\n    >\n      {renders}\n    </MRouterContext.Provider>\n  );\n};\n\nconst MRouterContextProvider = React.forwardRef(InternalMRouterContextProvider);\n\nMRouterContextProvider.displayName = \"MRouterContextProvider\";\n\ninterface MRouterPropsI {\n  permissionList?: string[];\n  wrapComponent?: React.FunctionComponent<any>;\n  hasAuth?: boolean;\n  routerConfig: RouterBaseConfigI;\n  children?: (children: React.ReactNode) => React.ReactNode;\n}\ninterface CoreRouterPropsI extends MRouterPropsI {\n  RouterComponent: typeof BrowserRouter | typeof HashRouter;\n}\nconst CoreRouter: React.FC<CoreRouterPropsI> = ({\n  permissionList,\n  wrapComponent: WrapComponent,\n  hasAuth = true,\n  routerConfig,\n  children,\n  RouterComponent\n}) => {\n  const syncUpdateCurrentRouteRef = useRef<{\n    updateCurrentRoute: (location: Location) => void;\n  }>(null!);\n  const syncUpdateCurrentRoute = useCallback(location => {\n    syncUpdateCurrentRouteRef.current?.updateCurrentRoute?.(location);\n  }, []);\n\n  if (__DEV__) {\n    /** Determine whether routerConfig has ‘_isDefined’ attribute */\n    if (!routerConfig._isDefined) {\n      console.error(\n        `The routerConfig does not call defineRouterConfig definition, You should use 'const routerConfig = defineRouterConfig({...})'`\n      );\n    }\n    /** Judge incoming 'WrapComponent' and 'children' */\n    if (WrapComponent && children) {\n      console.warn(\n        `MRouter attributes 'children' and 'WrapComponent' are optional attributes. If both exist, children will be used`\n      );\n    }\n    if (children && typeof children !== \"function\") {\n      console.error(\n        'MRoute attributes children needs to be a function, not a function at present  \"%s\"',\n        children\n      );\n    }\n  }\n\n  const _children = useMemo(() => {\n    if (children && typeof children === \"function\") {\n      return children;\n    }\n    if (WrapComponent) {\n      WrapComponent.displayName = \"WrapComponent\";\n      return function wrapComponent(children: React.ReactNode) {\n        return <WrapComponent>{children}</WrapComponent>;\n      };\n    }\n  }, [WrapComponent, children]);\n\n  return (\n    <RouterComponent syncUpdateCurrentRoute={syncUpdateCurrentRoute}>\n      <MRouterContextProvider\n        routerConfig={routerConfig}\n        permissionList={permissionList}\n        hasAuth={hasAuth}\n        ref={syncUpdateCurrentRouteRef}\n      >\n        {_children}\n      </MRouterContextProvider>\n    </RouterComponent>\n  );\n};\n\nconst MRouter: React.FC<MRouterPropsI> = props => {\n  return <CoreRouter {...props} RouterComponent={BrowserRouter} />;\n};\n\nconst MHRouter: React.FC<MRouterPropsI> = props => {\n  return <CoreRouter {...props} RouterComponent={HashRouter} />;\n};\n\nexport {\n  MRouter,\n  MHRouter,\n  useAddRoutes,\n  useRemoveRoutes,\n  useUpdateRoutes,\n  useBeforeLeave,\n  useRouter,\n  useHistory,\n  useNavigate\n};\n"],"names":["PageConfig","title","img","NoAuth","code","config","React","createElement","style","display","justifyContent","alignItems","background","height","flexDirection","borderRadius","alt","width","src","color","lineHeight","textAlign","marginTop","displayName","NameRedirect","name","component","Component","routesMap","currentRoute","useRouter","targetRoute","Navigate","to","path","Spin","tip","LoadingCmp","Fragment","changeable","LoadingComponent","setChangeable","options","Object","entries","forEach","key","value","getComponent","ReplaceComponent","isComponent","isString","Redirect","GeneratorHookCom","beforeEnter","beforeEachMount","CurrentComponent","setCurrentComponent","useState","undefined","useLayoutEffect","isActive","EachReplaceComponent","enterOptions","EnterReplaceComponent","NotFound","incrementKey","getIncrementName","getWholePath","basename","parentPath","startsWith","endsWith","slice","cloneRoutes","_routeConfig","routes","parent","_level","_cloneRoutes","_routes","map","_route","items","children","resets","wholePath","newRoute","getValidPathname","_relativePath","computedNewState","inputRoutes","permissionList","hasAuth","location","authInputRoutes","computeRoutesConfig","flattenRoutes","flattenRoutesFn","mixinNotFoundPage","routesMapFn","getCurrentRoute","pathname","currentPathRoutes","getCurrentPathRoutes","arr","all","reduce","prev","nextRoute","Array","isArray","concat","_routeMap","Error","includes","_path","replace","__paramsRoutesMap","__flattenRoutes","window","paths","keys","pathIndex","length","pathPattern","RegExp","match","i","filter","longerPath","pathStartMarkTransform","_isHasAuth","meta","pathRoute","unshift","executeEventCbs","option","from","callbacks","finish","executeNextCb","cbIndex","nextCb","fn","getIsHasAuthByStrCode","getIsHasAuthByFnCode","route","getIsHasAuth","some","_code","Function","redirect","type","other","_children","_items","props","isHasAuth","noAuthItems","hidden","_component","returnRoute","_itemsAndChildren","redirectPath","handleRedirectPath","getCurrentRouteCbsByEvent","routeEvent","routeHooks","getRealTo","childRoute","notFoundPath","hasNotFoundPage","notFoundPage","push","str","_defineId","defineRouterConfig","routerConfig","_config","_isDefined","flattenArr","ary","pre","cur","initialStateMap","Map","getSameQueryData","prevData","currentData","getInitialState","currentQueryData","get","isSameQueryData","queryData","initialData","_initialState","set","MRouterHistoryContext","createContext","useHistory","useContext","history","useRouteHooksRef","routeHooksRef","useHistoryMethods","historyMethods","BrowserRouter","syncUpdateCurrentRoute","historyRef","useRef","current","createBrowserHistory","historyContext","useMemo","go","state","setState","action","mounted","listen","routeData","unstable_batchedUpdates","Provider","Router","navigationType","navigator","HashRouter","createHashHistory","RouteNavTypeEnum","RouterActionEnum","newInputRoutesState","_cloneInputRoutes","addRoutesAction","payload","hasChange","newRoutes","parentName","_parentRoute","newState","_getNewStateByNewInputRoutes","updateRoutesAction","newRoutesPayload","routeName","_newRouteData","newRouteData","assign","splice","indexOf","removeRoutesAction","routeNames","index","MRouterContext","methods","MRouterReducer","ADD_ROUTES","REMOVE_ROUTES","UPDATE_ROUTES","UPDATE_INPUT_ROUTES","UPDATE_CURRENT_ROUTE","UPDATE_STATE","useRouterState","useAddRoutes","addRoutes","useRemoveRoutes","removeRoutes","useUpdateRoutes","updateRoutes","DEFAULT_PERMISSION_LIST","useBeforeLeave","hooks","routeHook","useNavigate","oldNavigate","useOldNavigate","newCallback","useCallback","params","generatePath","query","queryStr","stringify","useLocation","routesMapRef","search","parse","routerParams","useParams","newNavigate","navigate","authRoutes","InternalMRouterContextProvider","ref","locationRef","oldHistoryMethods","autoDocumentTitle","inputRoutesRef","initialState","getNewStateByNewInputRoutesRef","_inputRoutes","dispatch","useReducer","useImperativeHandle","updateCurrentRoute","prevRoute","useEffect","join","document","allExecuteEventCbs","historyCb","beforeRouterLeaveCbs","beforeLeave","delta","res","back","forward","routesConfig","_computeRoutesConfig","_itemsRouteConfig","element","Suspense","fallback","nextRoutes","_routesConfig","routesChildren","useRoutes","renders","MRouterContextProvider","forwardRef","CoreRouter","wrapComponent","WrapComponent","RouterComponent","syncUpdateCurrentRouteRef","console","error","warn","MRouter","MHRouter"],"mappings":"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"}